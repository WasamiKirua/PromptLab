# PromptLab

PromptLab is a lightweight FastAPI app for experimenting with prompt workflows and JSON-based image templates. It combines a kawaii-themed UI with practical tools to generate prompts, captions, and images.

## Highlights

- **NanoBanana gallery**: Browse a grid of JSON prompt templates, preview them, and generate images.
- **Caption to Prompt**: Upload an image and get a structured prompt generated by your chosen provider.
- **Text to Prompt**: Describe an idea in text and generate a prompt from it.
- **Light/Dark theme**: Toggle on the Home page; the theme applies across all pages.
- **Template customizations**: NanoBanana templates are editable. If you change values in the JSON template, the modified JSON is what gets submitted (not the original reference file).

## Requirements

- Python 3.10+
- [uv](https://github.com/astral-sh/uv)

## Installation (uv)

```bash
uv venv
source .venv/bin/activate
uv pip install -r pyproject.toml
```

If you prefer syncing directly from `pyproject.toml`:

```bash
uv pip install -r pyproject.toml
```

## Running the App

```bash
uvicorn main:app --reload
```

Then open:

- Home: `http://127.0.0.1:8000/`
- NanoBanana: `http://127.0.0.1:8000/nano-banana`
- CaptionToPrompt: `http://127.0.0.1:8000/caption-to-prompt`
- TextToPrompt: `http://127.0.0.1:8000/text-to-prompt`
- Gallery: `http://127.0.0.1:8000/gallery`

## Configuration

Create a `.env` file (or copy from `.env.example` if present). Supported keys include:

- `GEMINI_API_KEY`
- `GROK_API_KEY`
- `OPENAI_API_KEY`

The UI saves API keys automatically as you change them.

## Interface Overview

### Home

- Landing page with a light/dark toggle.
- Theme selection is stored in local storage and applied to all pages.

### NanoBanana

- **Template gallery** with image previews.
- Each tile opens a page with a JSON template and **Generate Image** button.
- Templates are **customizable**: if you change values in the JSON, the updated JSON is submitted when generating.

### CaptionToPrompt

- Upload an image and select a target base model.
- Choose a provider (Gemini, Grok, OpenAI).
- Grok includes an optional NSFW toggle to control prompt behavior.

### TextToPrompt

- Provide a text description (“Dream your picture”).
- Choose a target base model and provider.
- Generates a prompt from text input.

## How Template Generation Works

1. A JSON template is loaded from `json_templates_in/`.
2. The template is optionally edited in the UI.
3. The edited JSON is sent to the server for image generation.
4. Generated images are saved in `static/images_generated/`.

## Project Layout (high level)

```
main.py                  # FastAPI app + routes
captioning_utils.py      # Caption + prompt generation utilities
prompts_lib.py           # Prompt helpers
json_templates_in/       # Source JSON templates
json_templates_out/      # Optional output JSON
templates/               # HTML templates
static/images/           # Preview thumbnails
static/images_generated/ # Generated outputs
```

## What to Add Next (ideas)

- Template editor UI with validation + schema hints
- Gallery filters and tags
- Batch generation for multiple templates
- History of generated images with prompt metadata
- Rate limiting and job queue for large batches
- Export/share functionality for generated images

## Notes

- The UI is designed for fast iteration on prompts and templates.
- NanoBanana routes are intended for JSON-template based generation.
- The app expects preview images to exist in `static/images/` for gallery cards.

---

If you want, I can also add screenshots and a short GIF walkthrough.
